-- 지역 매핑 테이블 생성
CREATE TABLE IF NOT EXISTS region_mappings (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    main_region VARCHAR(20) NOT NULL,
    adjacent_region VARCHAR(20) NOT NULL,
    priority_order INT NOT NULL,

    -- 인덱스 생성
    INDEX idx_main_region_priority (main_region, priority_order),

    -- 유니크 제약 (중복 매핑 방지)
    UNIQUE KEY uk_region_mapping (main_region, adjacent_region)
);

-- 초기 지역 매핑 데이터 삽입 (중복 방지)
INSERT IGNORE INTO region_mappings (main_region, adjacent_region, priority_order) VALUES
-- 서울
('서울', '경기', 1),
('서울', '인천', 2),

-- 경기
('경기', '서울', 1),
('경기', '인천', 2),
('경기', '강원', 3),
('경기', '충남', 4),

-- 인천
('인천', '서울', 1),
('인천', '경기', 2),

-- 부산
('부산', '울산', 1),
('부산', '경남', 2),

-- 울산
('울산', '부산', 1),
('울산', '경남', 2),
('울산', '경북', 3),

-- 대구
('대구', '경북', 1),
('대구', '경남', 2),

-- 광주
('광주', '전남', 1),
('광주', '전북', 2),

-- 대전
('대전', '세종', 1),
('대전', '충남', 2),
('대전', '충북', 3),

-- 세종
('세종', '대전', 1),
('세종', '충남', 2),
('세종', '충북', 3),

-- 강원
('강원', '경기', 1),
('강원', '충북', 2),
('강원', '경북', 3),

-- 충북
('충북', '세종', 1),
('충북', '대전', 2),
('충북', '충남', 3),
('충북', '강원', 4),
('충북', '경북', 5),

-- 충남
('충남', '세종', 1),
('충남', '대전', 2),
('충남', '경기', 3),
('충남', '전북', 4),

-- 전북
('전북', '전남', 1),
('전북', '충남', 2),
('전북', '경남', 3),

-- 전남
('전남', '광주', 1),
('전남', '전북', 2),
('전남', '경남', 3),
('전남', '제주', 4),

-- 경북
('경북', '대구', 1),
('경북', '경남', 2),
('경북', '강원', 3),

-- 경남
('경남', '부산', 1),
('경남', '울산', 2),
('경남', '전남', 3),
('경남', '경북', 4);

-- 제주는 인접 지역이 없으므로 데이터 없음 (제주만 전남과 연결)

-- 테이블 코멘트 추가
ALTER TABLE region_mappings COMMENT = '지역 인접 관계 매핑 테이블 - 버킷 정책 B3에서 사용';
